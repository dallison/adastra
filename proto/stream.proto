syntax = "proto3";

package stagezero.proto;

message StreamControl {
  enum Disposition {
    DEFAULT = 0;
    STAGEZERO = 1;
    CLIENT = 2;   // Stdout/err as event, stdin as request.
    FILENAME = 3; // To/from file
    FD = 4;       // To/from file descriptor
    CLOSE = 5;    // Close
    NOTIFY = 6;   // Special stream for startup notification
    LOGGER = 7;   // Send to client as log message.
  };

  // Direction is as seen from the point of view of the process.
  enum Direction {
    INPUT = 0;  // Input stream.
    OUTPUT = 1; // Output stream.
  };

  int32 stream_fd = 1;         // File descriptor for stream.
  bool tty = 2;                // Is a tty (isatty() = 1)
  Disposition disposition = 3; // Where data goes to or comes from
  Direction direction = 4;     // From the process's point of view.

  oneof data {
    string filename = 5; // File name for FILENAME (use $var for expressions)
    int32 fd = 6;        // File descriptor for FD.
  }
}
